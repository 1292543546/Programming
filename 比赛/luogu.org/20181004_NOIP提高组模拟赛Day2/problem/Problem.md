# **NOIP提高组模拟赛**

---

## **比赛背景**

2018年10月17日，`《Ingress Prime》`作为一款Ar游戏，居然出番了。

`Ingress`简单来说就是由因为新型能量`XM`的发现，人类时间分裂成两股势力`ENLIGHTENED启蒙军`以及`RESISTANCE反抗军`，玩家在现实世界中行走，通过`GPS`定位并占领`Portal能量塔`的游戏，玩家可以将三个占领了的`Portal`给`Link连接`起来，形成一个`FIELD战场`，用来利用或者抵挡`XM`能量的影响。

`hz2016`作为一个`ENLIGHTENED`自然要利用好`XM`能量，早日收集够`AP经验`升级，来抵挡`RESISTANCE`的入侵啦。

[Ingress官网](https://ingress.com)

---

## Agent2

**Time:$1000MS$ Memory:$256MB$**

### **题目背景**

炎炎夏日还没有过去，`Agent`们没有一个想出去外面搞事情的。每当`ENLIGHTENED总部`组织活动时，人人都说有空，结果到了活动日，却一个接着一个`咕咕咕`了。只有不咕鸟`Lyn_king`一个人冒着太阳等了半个多小时，然后居然看到连`ENLIGHTENED行动参谋`都`咕咕咕`了，果然`咕咕咕`是人类的本性啊。

### **题目描述**

作为一个`ENLIGHTENED行动指挥`，自然不想看到这一点，于是他偷取到了那些经常`咕咕咕`的`Agent`的在下来$N$天的`活动安排表`，并且叫上了你来整理。在整理过程中，`ENLIGHTENED行动指挥`对你说了$M$条命令，命令操作如下。
1. 输入$0$ $a$ $b$，这代表在第$a$天到第$b$天，有一名`Agent`要咕咕咕。
2. 输入$1$ $a$，这代表`ENLIGHTENED行动指挥`询问你根据目前的信息，在第$a$天有多少名`Agent`会咕咕咕。

作为同是不咕鸟的你，也想要惩戒那些经常`咕咕咕`的人，所以，请协助完成`ENLIGHTENED行动指挥`完成整理，并且在他每次询问时，输出正确的答案。

### **输入格式**

第一行输入两个整数输$N,M$，
下来$M$行,每行输入一个命令，命令格式见题目描述。

### **输出格式**

对于每一次询问的操作，都要输出询问的答案。答案之间用换行隔开。

### **样例输入**

**Input**

> 5 5
> 0 1 2
> 0 1 5
> 1 1
> 0 3 5
> 1 5

### **样例输出**

**OutPut**

> 2
> 2

**样例解析**

> $1$~$2$天有一名`Agent`要咕咕咕，给他个名字`A`
> $1$~$5$天有一名`Agent`要咕咕咕，给他个名字`B`
> 样例询问第$1$天有多少名`Agent`要咕咕咕，可以看出`AB`都在第一天要咕咕咕，有两个人，所以输出$2$
> $3$~$5$天有一名`Agent`要咕咕咕，给他个名字`C`
> 样例询问第$5$天有多少名`Agent`要咕咕咕，可以看出`BC`都在第五天要咕咕咕，有两个人，所以输出$2$

### **数据范围**

对于$20\%$的数据 $N,M \leq 10$

对于$40\%$的数据 $N,M \leq 10^3$

对于$60\%$的数据 $N,M \leq 10^5$

对于$100\%$的数据 $1 \leq a \leq b \leq N \leq 10^7,M \leq 4*10^5$

---

## Portal2

**Time:$3000MS$ Memory:$512MB$**

### **题目背景**

某地`ENLIGHTENED`的`XM`研究所正在研究`Portal`的处理法则，想要揭示`XM能量`的来源以及应用`XM能量`。`ENLIGHTENED`的首席科学家`Jacks`发现其能量的运算法则以及运算方法，但是方法十分复杂，仅靠人手工计算是很难算出答案的，所以它需要你协助他完成计算。

### **题目描述**

`Portal`计算`XM能量`是通过个$2$个栈（$0$号栈，$1$号栈）实现的，它把对`XM`能量的操作如下

$PUSH$ $X$ $NUM$
把$NUM$加入到X号栈的栈顶。 
$POP$ $X$
把$X$号栈的栈顶元素**删除**。
$ADD$ $X$
**取出**$0$号栈和$1$号栈的元素各一个，并且把它的和放入$X$号栈。
$SUB$ $X$
**取出**$0$号栈和$1$号栈的元素各一个，并且把它的差的绝对值放入$X$号栈。 
$DEL$ $X$
**清空**$X$号栈中所有元素不管栈是否为空。 
$MOVE$ $X$ $Y$ 
循环操作直到$Y$号栈为空，把$Y$号栈的栈顶元素加入到$X$号栈，删除$Y$号栈的栈顶元素。 
**数据保证X和Y不相同**
$SWAP$
将两个栈的所有元素调换。
$END$
代表命令结束，并且分两行分别输出0号栈和1号栈由栈顶到栈底的元素的值，若栈内无元素，输出`NONE`。数据保证指令以`END`结束且仅有一个`END`，并且也需要输出`SUCCESS`。
对于每一行指令，若当前指令成功执行输出`SUCCESS`，若**取出或删除**元素时栈内为空输出`UNSUCCESS`并且不执行该行指令。

### **输入格式**

输入若干行指令，以`END`指令结束

### **输出格式**

对于每一次操作，都要对应输出`SUCCESS`或者`UNSUCCESS`，对于`END`根据指令描述输出栈内元素。

### **样例输入**

**Input1**

> PUSH 0 10
> PUSH 0 20
> PUSH 0 30
> PUSH 0 40
> PUSH 1 50
> PUSH 1 60
> ADD 0
> ADD 0
> ADD 0
> END

**Input2**

>PUSH 0 10
>PUSH 0 20
>PUSH 0 30
>PUSH 0 40
>PUSH 1 50
>PUSH 1 60
>MOVE 0 1
>END

### **样例输出**

**OutPut1**

> SUCCESS
> SUCCESS
> SUCCESS
> SUCCESS
> SUCCESS
> SUCCESS
> SUCCESS
> SUCCESS
> UNSUCCESS
> SUCCESS
> 150 30 20 10
> NONE

**样例解析**

>在PUSH完之后栈内的元素为，左到右分别从栈顶到栈底。
>40 30 20 10
>60 50
>ADD指令之后
>100 30 20 10
>50
>第二次ADD指令之后
>150 30 20 10
>NONE

**OutPut2**

> SUCCESS
> SUCCESS
> SUCCESS
> SUCCESS
> SUCCESS
> SUCCESS
> SUCCESS
> SUCCESS
> 50 60 40 30 20 10
> NONE

**样例解析**

>在PUSH完之后栈内的元素为，左到右分别从栈顶到栈底。
>40 30 20 10
>60 50
>MOVE指令之后，先取出1号栈元素一个放入0号栈
>60 40 30 20 10
>50
>循环操作至1号栈为空
>50 60 40 30 20 10
>NONE

### **数据范围**

对于$20\%$的数据 数据保证不会出现`MOVE/SWAP`操作，$命令总数 \leq 100$

对于$40\%$的数据 $命令总数 \leq 1000$

对于$60\%$的数据 数据保证`MOVE/SWAP`的操作次数不会超过$10000$次，$命令总数 \leq 10^5$

对于$100\%$的数据 $0 \leq X,Y \leq 1,命令总数 \leq 10^6$ 

**数据保证无论任何情况，栈中元素的值$X$满足$0 \leq x \leq 2^{63}-1​$**

---

## War2

**Time:$2000MS$ Memory:$128MB$**

### **题目背景**

`XM大战`如期而至，`Agent`们齐聚一地，展开最后的对决。对战有很多种方式，有些复杂的方式可以获得更高的分数。可惜`ENLIGHTENED`的人并不怎么聪明，只会简单的`hack`，所以`ENLIGHTENED行动指挥`找到了你来做他们的总参谋。

### **题目描述**

地图上有$N$个`Portal`，现在某一名`Agent`的任务是占领该地图上的$M$个`Portal`，这名`Agent`占领第$i$个`Portal`可以得到的分数为$A[i]$，除了直接占领，还有其他的$K$种加分方式，对于着$N$个`Portal`，在占领完第$X[i]$个`Portal`后占领第$Y[i]$个`Portal`可以获得$B[i]$的加分，加分可能会有重复。`Agent`希望他可以为团队争取更多的分数，所以请求作为大战参谋的你来帮助他。

### **输入格式**

第一行是输入三个整数$N,M,K$
第二行输入是$N$个数，第$i$个数代表$A[i]$的值。
下面$K$行每行有3个整数$X[i],Y[i],C[i]$，表示在占领完第$X[i]$个`Portal`后占领第$Y[i]$个`Portal`可以获得$B[i]$的加分

### **输出格式**

输出仅一行一个整数，为该名`Agent`可以获得的最大分数值。

### **样例输入**

**Input 1**

>3 2 1
>1 1 1
>1 2 3

**Input 2**

> 4 3 2
> 1 1 1 1
> 4 3 2
> 3 2 1

### **样例输出**

**OutPut 1**

> 5

**样例解析**

> 先占领$(1)$获得$1$点分数，后占领$(2)$获得$1$点基础分数，再获得$(1)->(2)$的加分$3$点，最高$5$分

**OutPut2**

> 6

**样例解析**

> 先占领$(4)$获得$1$点分数，后占领$(3)$获得$1$点基础分数，再获得$(4)->(3)$的加分$2$点，然后再占领$(2)$获得1点基础分数，再获得$(3)->(2)$的加分$1$点，最高$6$分。

### **数据范围**

对于$20\%$的数据 $1 \leq M \leq N \leq 4,0 \leq A[i],B[i] \leq 10^3$

对于$40\%$的数据 $1 \leq M \leq N \leq 8,0 \leq A[i],B[i] \leq 10^5$

对于$60\%$的数据 $1 \leq M \leq N \leq 12,0 \leq A[i],B[i] \leq 10^7$

对于$100\%$的数据 $1 \leq M,X[i],Y[i] \leq N \leq 18,0 \leq K \leq N^2−N,0 \leq A[i],B[i] \leq 10^9$
